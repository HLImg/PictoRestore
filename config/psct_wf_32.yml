seed: 10
root_dir: results
run_name: psct-wf32_sidd


model:
    name: StandardModel
    num_nodes: 1
    train_freq: 50
    test_freq: 2000
    save_freq: !!float 5e3
    iteration: !!float 4e5
    gradient_accumulation: 1

    best_metric: 
        name: psnr_rgb
        value: 30

    loader:
        train:
            batch_size: 4
            shuffle: True
            num_workers: 2
        test:
            batch_size: 1
            shuffle: False
            num_workers: 2

    optim:
        name: AdamW
        param:
            lr: 1.e-3
            weight_decay: 0.
            betas: [0.9, 0.9]

    schedule:
        name: CosineAnnealingLR
        T_max : 3200000 # 单卡 4e5 x 8 (gpu个数)
        eta_min : 1.e-7

data:
    train:
        name: SIDDPairDataset
        param:
            lq_path: /data/dataset/low_level/sidd_tmp//train_noisy.lmdb
            hq_path: /data/dataset/low_level/sidd_tmp//train_gt.lmdb
            patch_size: 256
            scale: 1
            flip: False
            rotation: False
            read_mode: lmdb
    test:
        name: SIDDPairDataset
        param:
            lq_path: /data/dataset/low_level/sidd_tmp//val_noisy.lmdb
            hq_path: /data/dataset/low_level/sidd_tmp//val_gt.lmdb
            read_mode: lmdb

arch:
    name: SCTUnet
    in_ch : 3
    num_feats : 32
    num_enc_blk: [2, 2, 2]
    num_mid_blk: 2
    num_dec_blk: [2, 2, 2]
    blk_name : ssct
    blk_param :
        head_dim_s: 32
        head_num_c: 4
        winsize: 8
        mlp_ratio_s: 2
        mlp_ratio_c: 2
        drop_prob_s: 0.1
        drop_prob_c: 0.1
        bias: False
        pool: False
        pool_mode: conv
        shortcut_prob: 0.5

loss:
    PSNRLoss:
        weight: 1.
        reduction: mean
        toY: False


metric:
    psnr_rgb:
        crop_border: 0
        input_order: HWC
        test_y_channel: False
    ssim_rgb:
        crop_border: 0
        input_order: HWC
        test_y_channel: False